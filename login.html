<!DOCTYPE html>
<html lang="nb">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MyChild - Login</title>
    
    <!-- Favicon and Theme Colors -->
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="icon" type="image/png" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='bg' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%23ff00ff'/><stop offset='50%' style='stop-color:%2300ffff'/><stop offset='100%' style='stop-color:%23ff00ff'/></linearGradient></defs><circle cx='50' cy='50' r='50' fill='url(%23bg)'/><circle cx='50' cy='45' r='25' fill='%23ffdbac'/><circle cx='42' cy='40' r='3' fill='%23000'/><circle cx='58' cy='40' r='3' fill='%23000'/><path d='M 40 50 Q 50 58 60 50' stroke='%23000' stroke-width='2' fill='none'/></svg>">
    <!-- theme-color is supported in modern browsers including Firefox 89+ -->
    <meta name="theme-color" content="#ff00ff">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MyChild">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" href="assets/favicon.svg">
    
    <link rel="stylesheet" href="css/style.css?v=2.0.0">
    <link rel="stylesheet" href="css/login.css?v=2.0.0">
    <style>
        .login-container {
            max-width: 95%;
            width: 100%;
            margin: 50px auto;
            padding: 40px;
            background: linear-gradient(135deg, #ffffff 0%, #fff0f5 50%, #e0f7ff 100%);
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(255,0,255,0.4), 0 0 30px rgba(0,255,255,0.3);
            border: 5px solid;
            border-image: linear-gradient(45deg, #ff00ff, #00ffff, #ffff00, #ff00ff) 1;
            position: relative;
            overflow: hidden;
            word-wrap: break-word;
            box-sizing: border-box;
            min-height: 0;
        }
        
        @media (min-width: 768px) {
            .login-container {
                max-width: 90%;
                padding: 50px;
            }
        }
        
        @media (min-width: 1200px) {
            .login-container {
                max-width: 85%;
                padding: 60px;
            }
        }
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow: hidden;
            word-wrap: break-word;
        }
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .form-group label {
            font-weight: bold;
            color: #333;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        .form-group input {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            width: 100%;
            box-sizing: border-box;
        }
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        .btn-primary {
            padding: 12px 24px;
            background: linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ff00ff 100%);
            background-size: 200% 200%;
            animation: gradientShift 3s ease infinite;
            color: white;
            border: 2px solid #ffffff;
            border-radius: 15px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 0 15px rgba(255,0,255,0.5);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
            min-height: 44px;
            width: 100%;
            box-sizing: border-box;
        }
        .btn-primary:hover, .btn-primary:active {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 5px 25px rgba(255,0,255,0.8);
        }
        @media (max-width: 768px) {
            .btn-primary {
                padding: 14px 24px;
                font-size: 18px;
            }
        }
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .character-customization {
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, #fff0f5 0%, #e0f7ff 100%);
            border-radius: 20px;
            border: 3px solid #ff00ff;
            box-shadow: 0 0 15px rgba(255,0,255,0.3);
            overflow: hidden;
            word-wrap: break-word;
        }
        .customization-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 15px;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .customization-options {
                grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
                gap: 25px;
            }
        }
        .customization-options:has(#startAge) {
            display: flex;
            justify-content: center;
        }
        .option-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            position: relative;
        }
        .option-group label {
            font-size: 14px;
            color: #666;
            font-weight: 500;
            word-wrap: break-word;
            overflow-wrap: break-word;
        }
        .option-group select, .option-group input {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            width: 100%;
            box-sizing: border-box;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 8px center;
            background-size: 16px;
            padding-right: 32px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .option-group select:focus, .option-group input:focus {
            outline: none;
            border-color: #ff00ff;
            box-shadow: 0 0 10px rgba(255,0,255,0.4);
        }
        .option-group select {
            cursor: pointer;
        }
        .emoji-picker {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(60px, 1fr));
            gap: 12px;
            margin-top: 10px;
            max-width: 100%;
            overflow: hidden;
        }
        
        @media (min-width: 768px) {
            .emoji-picker {
                grid-template-columns: repeat(8, 1fr);
                gap: 15px;
            }
        }
        
        @media (min-width: 1200px) {
            .emoji-picker {
                grid-template-columns: repeat(10, 1fr);
            }
        }
        .emoji-option {
            font-size: 2em;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
        }
        .emoji-option:hover {
            border-color: #ff00ff;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255,0,255,0.5);
        }
        .emoji-option.selected {
            border-color: #ff00ff;
            background: linear-gradient(135deg, #ffe0f5 0%, #e0f5ff 100%);
            box-shadow: 0 0 15px rgba(255,0,255,0.6);
        }
        .avatar-preview {
            text-align: center;
            font-size: 4em;
            padding: 20px;
            background: linear-gradient(135deg, #fff0f5 0%, #e0f7ff 100%);
            border-radius: 50%;
            margin: 20px auto;
            width: 150px;
            height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 4px solid;
            border-image: linear-gradient(45deg, #ff00ff, #00ffff, #ffff00) 1;
            box-shadow: 0 0 20px rgba(255,0,255,0.5);
        }
    </style>
</head>
<body>
    <div class="login-container">
        <div style="position: absolute; top: 10px; right: 10px; z-index: 10; pointer-events: none;">
            <img src="assets/images/sticker2000.jpg" alt="2000s sticker" style="width: 80px; height: 80px; border-radius: 50%; border: 3px solid #ffffff; box-shadow: 0 0 15px rgba(255,0,255,0.5); filter: drop-shadow(0 0 10px rgba(0,255,255,0.5)); animation: float 3s ease-in-out infinite; transform: rotate(15deg);">
        </div>
        <div style="position: relative; z-index: 1; padding-right: 100px; padding-left: 20px;">
            <h1 style="background: linear-gradient(45deg, #ff00ff, #00ffff, #ff00ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-shadow: 3px 3px 0px #00ffff, -3px -3px 0px #ff00ff; overflow: hidden; text-overflow: ellipsis; word-wrap: break-word; max-width: 100%; margin: 0;">MyChild</h1>
            <p style="color: #ff00ff; margin-bottom: 30px; margin-top: 10px; font-weight: bold; overflow: hidden; text-overflow: ellipsis; word-wrap: break-word;">Velg verden og opprett nytt spill</p>
            
            <!-- Main Menu -->
            <nav class="main-menu" id="mainMenu">
                <div class="menu-tabs">
                    <button class="menu-tab active" id="newGameTab" data-option="newGame">
                        <span class="menu-icon">üéÆ</span>
                        <span class="menu-text">Nytt Spill</span>
                    </button>
                    <button class="menu-tab" id="loadGameTab" data-option="loadGame">
                        <span class="menu-icon">üìÇ</span>
                        <span class="menu-text">Last Inn</span>
                    </button>
                    <button class="menu-tab" id="settingsTab" data-option="settings">
                        <span class="menu-icon">‚öôÔ∏è</span>
                        <span class="menu-text">Innstillinger</span>
                    </button>
                </div>
            </nav>
        </div>
        
        <style>
        @media (max-width: 768px) {
            .login-container > div[style*="padding-right: 100px"] {
                padding-right: 20px !important;
                padding-left: 10px !important;
            }
            .login-container > div[style*="top: 10px; right: 10px"] img {
                width: 60px !important;
                height: 60px !important;
            }
            .world-selection > div[style*="grid-template-columns: 1fr 1fr"] {
                grid-template-columns: 1fr !important;
                gap: 15px !important;
            }
            .world-option {
                min-height: 60px !important;
            }
            .menu-tabs {
                flex-direction: column !important;
            }
            .menu-tab {
                width: 100% !important;
                margin-bottom: 10px !important;
            }
        }
        </style>
        <style>
            @keyframes float {
                0%, 100% { transform: translateY(0) rotate(15deg); }
                50% { transform: translateY(-10px) rotate(20deg); }
            }
        </style>
        
        <!-- New Game Form -->
        <form class="login-form" id="loginForm">
            <!-- World Selection -->
            <div class="world-selection">
                <h3>üåç Velg Verden</h3>
                <div class="world-selection-grid">
                    <div class="world-option world-option-2000s" id="world2000s" data-world="2000s">
                        <div class="world-option-emoji">üòä</div>
                        <h4>2000-tallet</h4>
                        <p>Hyggelig og normal verden. Klassiske utfordringer med venner, skole og vekst.</p>
                    </div>
                    <div class="world-option world-option-2085" id="world2085" data-world="2085">
                        <div class="world-option-emoji">üåÜ</div>
                        <h4>2085 Dystopia</h4>
                        <p>Dystopisk fremtid. Oljefondet er tomt, klimaet kollapser, AI tar over. Kan du redde fremtiden?</p>
                    </div>
                </div>
                <input type="hidden" id="worldMode" name="worldMode" value="2000s">
            </div>
            
            <div class="form-group">
                <label for="username">Brukernavn:</label>
                <input type="text" id="username" name="username" autocomplete="username" required placeholder="Skriv ditt brukernavn">
            </div>
            
            <div class="character-customization">
                <h3>Karaktertilpasning</h3>
                
                <div class="avatar-preview" id="avatarPreview">üë∂</div>
                
                <div class="customization-options">
                    <div class="option-group">
                        <label for="gender">Kj√∏nn:</label>
                        <select id="gender" name="gender" aria-label="Velg kj√∏nn">
                            <option value="boy">Gutt</option>
                            <option value="girl">Jente</option>
                        </select>
                    </div>
                    
                    <div class="option-group">
                        <label for="childName">Navn:</label>
                        <input type="text" id="childName" name="childName" autocomplete="name" placeholder="Navn (valgfritt)">
                    </div>
                    
                    <div class="option-group">
                        <label for="siblings">S√∏sken:</label>
                        <select id="siblings" name="siblings" aria-label="Velg s√∏sken">
                            <option value="none">Ingen s√∏sken</option>
                            <option value="younger_brother">Yngre bror</option>
                            <option value="younger_sister">Yngre s√∏ster</option>
                            <option value="older_brother">Eldre bror</option>
                            <option value="older_sister">Eldre s√∏ster</option>
                            <option value="twin_brother">Tvillingbror</option>
                            <option value="twin_sister">Tvillings√∏ster</option>
                        </select>
                    </div>
                </div>
                
                <!-- Alder midt mellom de to √∏verste -->
                <div class="customization-options" style="margin-top: 15px; justify-content: center;">
                    <div class="option-group" style="max-width: 200px; margin: 0 auto;">
                        <label for="startAge">Alder (start):</label>
                        <select id="startAge" name="startAge" aria-label="Velg startalder">
                            <option value="0">Baby (0 √•r)</option>
                            <option value="1">1 √•r</option>
                            <option value="2">2 √•r</option>
                            <option value="3">3 √•r</option>
                            <option value="4">4 √•r</option>
                            <option value="5">5 √•r</option>
                            <option value="6">6 √•r</option>
                            <option value="7">7 √•r</option>
                            <option value="8">8 √•r</option>
                            <option value="9">9 √•r</option>
                            <option value="10">10 √•r</option>
                            <option value="11">11 √•r</option>
                            <option value="12">12 √•r</option>
                            <option value="13">13 √•r</option>
                            <option value="14">14 √•r</option>
                            <option value="15">15 √•r</option>
                            <option value="16">16 √•r</option>
                            <option value="17">17 √•r</option>
                            <option value="18">18 √•r</option>
                            <option value="19">19 √•r</option>
                            <option value="20">20 √•r</option>
                            <option value="21">21 √•r</option>
                            <option value="22">22 √•r</option>
                            <option value="23">23 √•r</option>
                            <option value="24">24 √•r</option>
                            <option value="25">25 √•r</option>
                            <option value="26">26 √•r</option>
                            <option value="27">27 √•r</option>
                            <option value="28">28 √•r</option>
                            <option value="29">29 √•r</option>
                            <option value="30">30 √•r</option>
                            <option value="31">31 √•r</option>
                            <option value="32">32 √•r</option>
                            <option value="33">33 √•r</option>
                            <option value="34">34 √•r</option>
                            <option value="35">35 √•r</option>
                            <option value="36">36 √•r</option>
                            <option value="37">37 √•r</option>
                            <option value="38">38 √•r</option>
                            <option value="39">39 √•r</option>
                            <option value="40">40 √•r</option>
                            <option value="41">41 √•r</option>
                            <option value="42">42 √•r</option>
                            <option value="43">43 √•r</option>
                            <option value="44">44 √•r</option>
                            <option value="45">45 √•r</option>
                            <option value="46">46 √•r</option>
                            <option value="47">47 √•r</option>
                            <option value="48">48 √•r</option>
                            <option value="49">49 √•r</option>
                            <option value="50">50 √•r</option>
                            <option value="51">51 √•r</option>
                            <option value="52">52 √•r</option>
                            <option value="53">53 √•r</option>
                            <option value="54">54 √•r</option>
                            <option value="55">55 √•r</option>
                            <option value="56">56 √•r</option>
                            <option value="57">57 √•r</option>
                            <option value="58">58 √•r</option>
                            <option value="59">59 √•r</option>
                            <option value="60">60 √•r</option>
                            <option value="61">61 √•r</option>
                            <option value="62">62 √•r</option>
                            <option value="63">63 √•r</option>
                            <option value="64">64 √•r</option>
                            <option value="65">65 √•r</option>
                            <option value="66">66 √•r</option>
                            <option value="67">67 √•r</option>
                            <option value="68">68 √•r</option>
                            <option value="69">69 √•r</option>
                            <option value="70">70 √•r</option>
                            <option value="71">71 √•r</option>
                            <option value="72">72 √•r</option>
                            <option value="73">73 √•r</option>
                            <option value="74">74 √•r</option>
                            <option value="75">75 √•r</option>
                            <option value="76">76 √•r</option>
                            <option value="77">77 √•r</option>
                            <option value="78">78 √•r</option>
                            <option value="79">79 √•r</option>
                            <option value="80">80 √•r</option>
                            <option value="81">81 √•r</option>
                            <option value="82">82 √•r</option>
                            <option value="83">83 √•r</option>
                            <option value="84">84 √•r</option>
                            <option value="85">85 √•r</option>
                            <option value="86">86 √•r</option>
                            <option value="87">87 √•r</option>
                            <option value="88">88 √•r</option>
                            <option value="89">89 √•r</option>
                            <option value="90">90 √•r</option>
                            <option value="91">91 √•r</option>
                            <option value="92">92 √•r</option>
                            <option value="93">93 √•r</option>
                            <option value="94">94 √•r</option>
                            <option value="95">95 √•r</option>
                            <option value="96">96 √•r</option>
                        </select>
                    </div>
                </div>
                
                <div class="option-group" style="margin-top: 15px;">
                    <label>Velg emoji for karakteren:</label>
                    <div class="emoji-picker" id="emojiPicker">
                        <div class="emoji-option" data-emoji="üë∂">üë∂</div>
                        <div class="emoji-option" data-emoji="üßí">üßí</div>
                        <div class="emoji-option" data-emoji="üë¶">üë¶</div>
                        <div class="emoji-option" data-emoji="üëß">üëß</div>
                        <div class="emoji-option" data-emoji="üßë">üßë</div>
                        <div class="emoji-option" data-emoji="üë®">üë®</div>
                        <div class="emoji-option" data-emoji="üë©">üë©</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçü¶±">üßë‚Äçü¶±</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçü¶±">üë®‚Äçü¶±</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçü¶±">üë©‚Äçü¶±</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçü¶∞">üßë‚Äçü¶∞</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçü¶∞">üë®‚Äçü¶∞</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçü¶∞">üë©‚Äçü¶∞</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçü¶≥">üßë‚Äçü¶≥</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçü¶≥">üë®‚Äçü¶≥</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçü¶≥">üë©‚Äçü¶≥</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçü¶≤">üßë‚Äçü¶≤</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçü¶≤">üë®‚Äçü¶≤</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçü¶≤">üë©‚Äçü¶≤</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçüéì">üë®‚Äçüéì</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçüéì">üë©‚Äçüéì</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçüéì">üßë‚Äçüéì</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçüíº">üë®‚Äçüíº</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçüíº">üë©‚Äçüíº</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçüíº">üßë‚Äçüíº</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçüé§">üßë‚Äçüé§</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçüé§">üë®‚Äçüé§</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçüé§">üë©‚Äçüé§</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçüé®">üßë‚Äçüé®</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçüé®">üë®‚Äçüé®</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçüé®">üë©‚Äçüé®</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçüè´">üßë‚Äçüè´</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçüè´">üë®‚Äçüè´</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçüè´">üë©‚Äçüè´</div>
                        <div class="emoji-option" data-emoji="üßë‚Äç‚öïÔ∏è">üßë‚Äç‚öïÔ∏è</div>
                        <div class="emoji-option" data-emoji="üë®‚Äç‚öïÔ∏è">üë®‚Äç‚öïÔ∏è</div>
                        <div class="emoji-option" data-emoji="üë©‚Äç‚öïÔ∏è">üë©‚Äç‚öïÔ∏è</div>
                        <div class="emoji-option" data-emoji="üßë‚Äçüî¨">üßë‚Äçüî¨</div>
                        <div class="emoji-option" data-emoji="üë®‚Äçüî¨">üë®‚Äçüî¨</div>
                        <div class="emoji-option" data-emoji="üë©‚Äçüî¨">üë©‚Äçüî¨</div>
                        <div class="emoji-option" data-emoji="üßë‚ÄçüöÄ">üßë‚ÄçüöÄ</div>
                        <div class="emoji-option" data-emoji="üë®‚ÄçüöÄ">üë®‚ÄçüöÄ</div>
                        <div class="emoji-option" data-emoji="üë©‚ÄçüöÄ">üë©‚ÄçüöÄ</div>
                        <div class="emoji-option" data-emoji="üßë‚Äç‚úàÔ∏è">üßë‚Äç‚úàÔ∏è</div>
                        <div class="emoji-option" data-emoji="üë®‚Äç‚úàÔ∏è">üë®‚Äç‚úàÔ∏è</div>
                        <div class="emoji-option" data-emoji="üë©‚Äç‚úàÔ∏è">üë©‚Äç‚úàÔ∏è</div>
                    </div>
                </div>
                
                <div class="customization-options" style="margin-top: 15px;">
                    <div class="option-group">
                        <label for="hairColor">H√•rfarge:</label>
                        <select id="hairColor" name="hairColor" aria-label="Velg h√•rfarge">
                            <option value="blonde">Blond</option>
                            <option value="brown">Brun</option>
                            <option value="black">Svart</option>
                            <option value="red">R√∏d</option>
                            <option value="other">Annet</option>
                        </select>
                    </div>
                    
                    <div class="option-group">
                        <label for="eyeColor">√òyenfarge:</label>
                        <select id="eyeColor" name="eyeColor" aria-label="Velg √∏yenfarge">
                            <option value="blue">Bl√•</option>
                            <option value="brown">Brun</option>
                            <option value="green">Gr√∏nn</option>
                            <option value="hazel">N√∏ttebrun</option>
                            <option value="gray">Gr√•</option>
                        </select>
                    </div>
                    
                    <div class="option-group">
                        <label for="style">Stil:</label>
                        <select id="style" name="style" aria-label="Velg stil">
                            <option value="normal">Normal</option>
                            <option value="cap">Caps</option>
                            <option value="hoodie">Hoodie</option>
                            <option value="sporty">Sporty</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <button type="submit" class="btn-primary">Start Spill</button>
        </form>
        
        <!-- Load Game Section -->
        <div id="loadGameSection">
            <h3>Eksisterende spill:</h3>
            <div id="gamesList"></div>
        </div>
        
        <!-- Settings Section -->
        <div id="settingsSection">
            <h3>‚öôÔ∏è Innstillinger</h3>
            <div class="settings-content">
                <p><strong>Spillregler:</strong></p>
                <ul>
                    <li>Hvis alle stats (happiness, hunger, energy, social, learning) n√•r 0, d√∏r karakteren din.</li>
                    <li>Du kan velge startalder fra 0 til 96 √•r.</li>
                    <li>Spillet foreg√•r i √•r 2085 i en dystopisk fremtid.</li>
                    <li>Ta gode valg for √• redde fremtiden!</li>
                </ul>
            </div>
        </div>
    </div>
    
    <script>
        let selectedEmoji = 'üë∂';
        
        // Menu navigation
        function showMenuOption(option) {
            console.log('showMenuOption called with:', option);
            
            // Hide all sections
            const loginForm = document.getElementById('loginForm');
            const loadGameSection = document.getElementById('loadGameSection');
            const settingsSection = document.getElementById('settingsSection');
            
            if (loginForm) loginForm.style.display = 'none';
            if (loadGameSection) loadGameSection.style.display = 'none';
            if (settingsSection) settingsSection.style.display = 'none';
            
            // Remove active class from all tabs
            document.querySelectorAll('.menu-tab').forEach(tab => {
                tab.classList.remove('active');
                tab.style.background = '#f0f0f0';
                tab.style.color = '#333';
                tab.style.border = '2px solid #ddd';
            });
            
            // Show selected section and activate tab
            if (option === 'newGame') {
                if (loginForm) loginForm.style.display = 'block';
                const newGameTab = document.getElementById('newGameTab');
                if (newGameTab) {
                    newGameTab.classList.add('active');
                    newGameTab.style.background = 'linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ff00ff 100%)';
                    newGameTab.style.color = 'white';
                    newGameTab.style.border = '2px solid #ffffff';
                }
            } else if (option === 'loadGame') {
                if (loadGameSection) loadGameSection.style.display = 'block';
                const loadGameTab = document.getElementById('loadGameTab');
                if (loadGameTab) {
                    loadGameTab.classList.add('active');
                    loadGameTab.style.background = 'linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ff00ff 100%)';
                    loadGameTab.style.color = 'white';
                    loadGameTab.style.border = '2px solid #ffffff';
                }
                loadExistingGames();
            } else if (option === 'settings') {
                if (settingsSection) settingsSection.style.display = 'block';
                const settingsTab = document.getElementById('settingsTab');
                if (settingsTab) {
                    settingsTab.classList.add('active');
                    settingsTab.style.background = 'linear-gradient(135deg, #ff00ff 0%, #00ffff 50%, #ff00ff 100%)';
                    settingsTab.style.color = 'white';
                    settingsTab.style.border = '2px solid #ffffff';
                }
            }
        }
        
        // Load existing games
        function loadExistingGames() {
            const gamesList = document.getElementById('gamesList');
            gamesList.innerHTML = '';
            
            const games = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key.startsWith('mychild_game_')) {
                    try {
                        const gameData = JSON.parse(localStorage.getItem(key));
                        const username = key.replace('mychild_game_', '');
                        games.push({
                            username, 
                            day: gameData.day || 1, 
                            age: gameData.child?.age || 8,
                            lastSaved: gameData.lastSaved || null
                        });
                    } catch (e) {
                        console.error('Error loading game:', e);
                    }
                }
            }
            
            // Sort by last saved (most recent first)
            games.sort((a, b) => {
                if (!a.lastSaved) return 1;
                if (!b.lastSaved) return -1;
                return new Date(b.lastSaved) - new Date(a.lastSaved);
            });
            
            if (games.length === 0) {
                gamesList.innerHTML = '<p style="color: #666;">Ingen eksisterende spill</p>';
                return;
            }
            
            games.forEach(game => {
                const gameDiv = document.createElement('div');
                gameDiv.style.cssText = 'padding: 10px; margin: 5px 0; background: #f0f0f0; border-radius: 5px; cursor: pointer; display: flex; justify-content: space-between; align-items: center;';
                
                const lastSaved = game.lastSaved ? new Date(game.lastSaved).toLocaleString('no-NO') : 'Ukjent';
                const buttonDiv = document.createElement('div');
                buttonDiv.style.cssText = 'display: flex; gap: 5px;';
                
                const loadBtn = document.createElement('button');
                loadBtn.textContent = 'Last inn';
                loadBtn.style.cssText = 'padding: 5px 10px; background: #667eea; color: white; border: none; border-radius: 5px; cursor: pointer;';
                loadBtn.onclick = () => loadGame(game.username);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.textContent = 'üóëÔ∏è';
                deleteBtn.style.cssText = 'padding: 5px 10px; background: #dc3545; color: white; border: none; border-radius: 5px; cursor: pointer;';
                deleteBtn.onclick = () => {
                    if (confirm(`Er du sikker p√• at du vil slette spillet "${game.username}"?`)) {
                        try {
                            localStorage.removeItem(`mychild_game_${game.username}`);
                            localStorage.removeItem(`mychild_customization_${game.username}`);
                            loadExistingGames();
                        } catch (e) {
                            alert('Kunne ikke slette spillet.');
                        }
                    }
                };
                
                buttonDiv.appendChild(loadBtn);
                buttonDiv.appendChild(deleteBtn);
                
                gameDiv.innerHTML = `
                    <div>
                        <strong>${game.username}</strong> - Dag ${game.day}, ${game.age} √•r<br>
                        <small style="color: #666;">Sist lagret: ${lastSaved}</small>
                    </div>
                `;
                gameDiv.appendChild(buttonDiv);
                gamesList.appendChild(gameDiv);
            });
        }
        
        function loadGame(username) {
            window.location.href = `index.html?username=${encodeURIComponent(username)}`;
        }
        
        // Emoji picker
        document.querySelectorAll('.emoji-option').forEach(option => {
            option.addEventListener('click', function() {
                document.querySelectorAll('.emoji-option').forEach(o => o.classList.remove('selected'));
                this.classList.add('selected');
                selectedEmoji = this.dataset.emoji;
                document.getElementById('avatarPreview').textContent = selectedEmoji;
            });
        });
        
        // World selection
        function selectWorld(world) {
            console.log('selectWorld called with:', world);
            const worldModeInput = document.getElementById('worldMode');
            if (worldModeInput) {
                worldModeInput.value = world;
            }
            
            // Update visual selection
            document.querySelectorAll('.world-option').forEach(opt => {
                opt.style.transform = 'scale(1)';
                opt.style.boxShadow = '';
                opt.style.borderWidth = '3px';
            });
            
            const selectedOption = document.getElementById('world' + (world === '2085' ? '2085' : '2000s'));
            if (selectedOption) {
                selectedOption.style.transform = 'scale(1.05)';
                selectedOption.style.boxShadow = '0 0 20px rgba(255, 0, 255, 0.6)';
                selectedOption.style.borderWidth = '4px';
            }
        }
        
        // Add event listeners for world selection (works on both desktop and mobile)
        document.addEventListener('DOMContentLoaded', function() {
            // World selection buttons
            const worldOptions = document.querySelectorAll('.world-option');
            worldOptions.forEach(option => {
                const world = option.getAttribute('data-world');
                if (world) {
                    // Click event (desktop)
                    option.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        selectWorld(world);
                    });
                    
                    // Touch event (mobile)
                    option.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        selectWorld(world);
                    });
                }
            });
            
            // Menu tab buttons
            const menuTabs = document.querySelectorAll('.menu-tab');
            menuTabs.forEach(tab => {
                const option = tab.getAttribute('data-option');
                if (option) {
                    // Click event (desktop)
                    tab.addEventListener('click', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        showMenuOption(option);
                    });
                    
                    // Touch event (mobile)
                    tab.addEventListener('touchend', function(e) {
                        e.preventDefault();
                        e.stopPropagation();
                        showMenuOption(option);
                    });
                }
            });
        });
        
        // Initialize world selection (default to 2000s)
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                selectWorld('2000s');
            });
        } else {
            selectWorld('2000s');
        }
        
        // Form submission
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value.trim();
            const gender = document.getElementById('gender').value;
            const childName = document.getElementById('childName').value.trim() || (gender === 'girl' ? 'Jente' : 'Gutt');
            const startAge = parseInt(document.getElementById('startAge').value);
            const hairColor = document.getElementById('hairColor').value;
            const eyeColor = document.getElementById('eyeColor').value;
            const style = document.getElementById('style').value;
            const worldMode = document.getElementById('worldMode').value;
            const siblings = document.getElementById('siblings').value;
            
            if (!username) {
                alert('Vennligst skriv inn et brukernavn');
                return;
            }
            
            // Store character customization with world mode and siblings
            const customization = {
                gender,
                name: childName,
                age: startAge,
                emoji: selectedEmoji,
                hairColor,
                eyeColor,
                style,
                worldMode: worldMode || '2000s',
                siblings: siblings || 'none'
            };
            
            localStorage.setItem(`mychild_customization_${username}`, JSON.stringify(customization));
            
            // Redirect to game
            window.location.href = `index.html?username=${encodeURIComponent(username)}`;
        });
        
        // Load games on page load
        loadExistingGames();
        
        // Update preview when gender changes
        document.getElementById('gender').addEventListener('change', function() {
            const gender = this.value;
            const nameInput = document.getElementById('childName');
            if (!nameInput.value.trim()) {
                nameInput.value = gender === 'girl' ? 'Jente' : 'Gutt';
            }
        });
    </script>
</body>
</html>

